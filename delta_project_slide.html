<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Slides Custom Navigation</title>
    <style>
        .slide-container {
            position: relative;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
        }

        .slide-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            z-index: 10;
        }

        .chevron {
            background-color: rgba(0,0,255,0.5);
            color: white;
            border: none;
            padding: 10px;
            cursor: pointer;
            font-size: 24px;
            user-select: none;
            transition: background-color 0.3s;
        }

        .chevron:hover {
            background-color: rgba(0,0,255,0.7);
        }

        .progress-bar {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: white;
            border: 2px solid blue;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .progress-dot.active {
            background-color: blue;
        }

        .google-slide-iframe {
            width: 100%;
            max-width: 1000px;
            height: 850px;
            border: none;
        }
    </style>
</head>
<body>
    <div class="slide-container">
        <div class="slide-navigation">
            <button class="chevron prev-slide" onclick="navigateSlide(-1)">&#10094;</button>
            <button class="chevron next-slide" onclick="navigateSlide(1)">&#10095;</button>
        </div>

        <iframe 
            id="google-slides-iframe"
            class="google-slide-iframe"
            src="https://docs.google.com/presentation/d/e/2PACX-1vQjySdmK_14lv1zTWGU6oM28pU9meXSvquHSFN2PwPVbD7fO65HuZv-lVH73-3KRA/embed?start=false&loop=false&delayms=3000" 
            allowfullscreen="true" 
            mozallowfullscreen="true" 
            webkitallowfullscreen="true">
        </iframe>

        <div class="progress-bar" id="progress-dots">
            <!-- Dots will be dynamically generated -->
        </div>
    </div>

    <script>
        const iframe = document.getElementById('google-slides-iframe');
        const progressDotsContainer = document.getElementById('progress-dots');
        const totalSlides = 19;
        let currentSlide = 0;

        // Create progress dots
        function createProgressDots() {
            progressDotsContainer.innerHTML = '';
            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('div');
                dot.classList.add('progress-dot');
                if (i === 0) dot.classList.add('active');
                dot.setAttribute('data-slide', i);
                dot.onclick = () => goToSlide(i);
                progressDotsContainer.appendChild(dot);
            }
        }

        // Navigation functions
        function navigateSlide(direction) {
            let newSlide = currentSlide + direction;
            
            // Implement wrap-around logic
            if (newSlide < 0) newSlide = totalSlides - 1;
            if (newSlide >= totalSlides) newSlide = 0;
            
            goToSlide(newSlide);
        }

        function goToSlide(slideNum) {
            // Send message to Google Slides to navigate
            iframe.contentWindow.postMessage(
                JSON.stringify({
                    "method": "goToSlide",
                    "args": [slideNum]
                }), 
                "*"
            );

            // Update progress dots
            const dots = document.querySelectorAll('.progress-dot');
            dots.forEach(dot => dot.classList.remove('active'));
            dots[slideNum].classList.add('active');

            currentSlide = slideNum;
        }

        // Listen for messages from the iframe to track current slide
        window.addEventListener('message', function(event) {
            try {
                const data = JSON.parse(event.data);
                
                // Check if this is a slide change event
                if (data.method === 'onSlideChanged') {
                    currentSlide = data.args[0];
                    
                    // Update progress dots
                    const dots = document.querySelectorAll('.progress-dot');
                    dots.forEach(dot => dot.classList.remove('active'));
                    dots[currentSlide].classList.add('active');
                }
            } catch (error) {
                // Silently catch any parsing errors
                console.log('Message parsing error:', error);
            }
        });

        // Initialize progress dots when the page loads
        window.addEventListener('load', createProgressDots);
    </script>
</body>
</html>
